(defpackage :rsa-test
    (:use :cl :rsa))

(in-package :rsa-test)

;; para la longitud de la clave puede elegir entre
;; 512 - 1024 - 1536 - 2048

;(rsa::generar-claves 2048)

;(rsa::print-rsa)

;(generar-claves 2048)
;(print-rsa)
;(setq nro #x097aed9dad0fe4f60ca0c02d80782908175bab665e8989601d39cf626a00ca92)
;(format t "~A = ~X" nro nro)
;(setq nroc (encrypt nro e n))
;(setq nrod (decrypt nroc d n))
;(format t "original: ~X~%cifrado: ~X~%descifrado: ~X~%" nro nroc nrod)

;(setq firma #x8077E1A14855D33AA866950A1DB4B13A65802C04E83569199D0F0E2B600CD5B53FDDC0ED43A42226BF87C8E8CEE3B8088CAD48B69B8B38A7F450B89233280C61DF2B9A1C80E56A0D1619B797B7075DDA2F8F601C2D966AB06FAEDF626DA5797E988E40192E602CC3CF1110145D83BBA79F6B83C15B26F9B5E9FB9BFA331F762D7D776D1A69B5D76F91283F106D8D4DD15DBCE96D2485A30C440B33513418661AA9992F5457A5EC6ED9AD96EF647DD98D13BAB67E7984DE0E1455EF15F046C697FB2B1B5A8CA307D2F27A0E94A50211D7487098614E6A76C1788C815E2EC5223312356A1DD4606146EDCAD23AB911CE098C65BF8F37A18BECCFD4B5CE97D8070635684D765738C76FAC5C2634E1B6C272EC77EFDFA81BCE81DF1061D292A7BAC957DBA770DC6A1D378B1D589657378B9A4FD933E7EB44EF8639600098DE841AF76ACC4A579DF6410B702579ADED08BDAEFD137A5E42660D940B43B6C965094A2648B9033A66670C728B159D48DEA5C48A8701DEC43CD1D873EA48F41BE60B00E86EFAC8879D2D8897120C5F19E89D5E47BA79D73DEC63CBDC964BD70ABD5BFCC64781E25DD4B5FDC6F7176AC60352A7F4F288925B1399EAFAF917067D6E447C1F60888A6D1C240565BEB10A90892C09FD5D5B1E911E162A982E9D5B92009B44F299020CA164A9B87DE0F41D9345C005F8D23E22431A5E947900735BFF02FD257)
;(setq command (concatenate 'string "echo " (write-to-string firma :base 16)  " > hola.firma"))

;(format t "~A~%" command)

;(format t "~X~%" (parse-integer (write-to-string firma :base 16) :radix 16))